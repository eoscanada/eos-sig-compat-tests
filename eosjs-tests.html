<html>
<head>
  <meta charset="utf-8">
  <!--
  SRI Pinned from release notes hash https://github.com/EOSIO/eosjs-ecc/releases/tag/v4.0.4
  -->
  <script src="https://cdn.jsdelivr.net/npm/eosjs-ecc@4.0.4/lib/eosjs-ecc.min.js"
    integrity="sha512-dYFDmK/d9r3/NCp6toLtfkwOjSMRBaEzaGAx1tfRItC0nsI0hVLERk05iNBQR7uDNI7ludYhcBI4vUiFHdjsTQ=="
    crossorigin="anonymous"></script>
</head>
<body>
    <script>

    function importKey(priv, pub) {
        console.log("====================================================")    
        console.log("Importing existing private key to wallet : " + priv);
        const privObj = eosjs_ecc.PrivateKey(priv);
        console.log("Matching existing public key             : " + eosjs_ecc.privateToPublic(privObj));
        return privObj
    }

    function signAndCheck(message, pub, priv, keosdSig) {
        console.log("------------------")
        console.log("Signing message digest (" + message + ") with " + pub);
        sig = eosjs_ecc.signHash(message, priv);
        console.log("Signature : " + sig)

        recovPubKey = eosjs_ecc.recoverHash(keosdSig, message)
        console.log("Recovered key from KEOSD signature : " + recovPubKey);
        console.log("Assert key matches? " + (recovPubKey === pub).toString())
    }

    console.log("Tests from eos-js")

    privKeyToImport = "5JFhynQnFBYNTPDA9TiKeE7TmujNYaExcbZi9bsRUjhVxwZF4Mt";
    pubKeyToImport = "EOS5jSQLpKBHLaMtuzkftnYE6bCMA5Jxso8f22uZyKj6cDEp32eSj";
    privObj = importKey(privKeyToImport, pubKeyToImport)
    signAndCheck("89529cb031c69eccc92f3e8492393a8688bd3d071d7346677b6ff59d314d5121", pubKeyToImport, privObj, "SIG_K1_KVp1bPmzswSvbcZCMENXbawKFVXPyYrUeJNZ9ChgWdhxLd5K8WtRmCtFY5cqVFgxjCZH8CwdNkxM3HBZ7EXeJmzcK78mHA")
    signAndCheck("0000000000000000000000000000000000000000000000000000000000000000", pubKeyToImport, privObj, "SIG_K1_KiDE7eMg8tHm2wnjJgxyXGtxgMX21hF6uXmCdaKHjp6dxjyweKRsNVKa8iV8h23a45rRP65VazY8R1cKsk89rK2ZzgjnJi")
    signAndCheck("1111111111111111111111111111111111111111111111111111111111111111", pubKeyToImport, privObj, "SIG_K1_K7SZ7Kch5ubBioPd2GpLUCcQAdDJize252xgQ1kYrAwYibGo4qAZHWETdMXo4yanwa7CLzHLM8SCDi9Fga1FMJTXTQ1ztV")

    privKeyToImport = "5Kk2STsBpo6UkY5Uw8BQ1YeFjp2BGLiBEsC5h4TYYiRDb7y5BTR";
    pubKeyToImport = "EOS5gWrScGTTMyieGGhFDAmrVtDCp3UYzwdE7VLoZQnFSiGcezE3H";
    privObj = importKey(privKeyToImport, pubKeyToImport)
    signAndCheck("89529cb031c69eccc92f3e8492393a8688bd3d071d7346677b6ff59d314d5121", pubKeyToImport, privObj, "SIG_K1_KhAncPv4QcGwE2gTrwhPZyQLy23AoNTKPiuN1puiT1F2xrdz7zTWEFvTJnADGgAnrBHpe2YsRNQZJnhkKShCo1FRMfUec1")
    signAndCheck("0000000000000000000000000000000000000000000000000000000000000000", pubKeyToImport, privObj, "SIG_K1_KZQ3LcuJ741hKzGVjDNUPfYYBB5v88EZURFeyD1g3mxSx3MxzFAX5panzaAUyUugoLFRCxSw18qFtomtA6RSd8tRiQtKgs")
    signAndCheck("1111111111111111111111111111111111111111111111111111111111111111", pubKeyToImport, privObj, "SIG_K1_KfHdgQjHWdHetVcjc32PemVMsvSBxLSf5dvchauFa87QaXBaxadJ64UULasknsXhJLQu98vzEEgU6WbqEqJNebPtuJ7NEP")
    signAndCheck("2222222222222222222222222222222222222222222222222222222222222222", pubKeyToImport, privObj, "SIG_K1_Kf4omhweDa9fKDvR89qeVHGYfa2KccNdGvV7ng1uzVz7gERNLahRbGS5bZtWPdudUco7WApHXALTNZRVSvYknNoFKVAp8p")
    signAndCheck("3333333333333333333333333333333333333333333333333333333333333333", pubKeyToImport, privObj, "SIG_K1_KbBD8esKxZJiBtX1hfHGSCiytoNccoU5zKEHEWtWBdriUGwsmcRWkL8Zm1R3Tq7Uj9X7PW6vypfateHNuDKR8Az4maHhHo")
    signAndCheck("4444444444444444444444444444444444444444444444444444444444444444", pubKeyToImport, privObj, "SIG_K1_K8xFcoZKAvjCKZ5RGyVXKswhxwbztXjchMPRbk4vFc8jZaRpifMsDC57x6zjcPdmGzopsVLYmGu2EhfBzfqPBy3EB73KZq")
    signAndCheck("5555555555555555555555555555555555555555555555555555555555555555", pubKeyToImport, privObj, "SIG_K1_JwZVdQSqqpXVgdsBK2XtMdU13RTKsKmP16YxckMvMagC3nKpfAMSaz7Bnk4vWFyASsh2FuJoqGH9zXGtvDgXJvJo1qu9hU")
    signAndCheck("BBBBBBBBBBBBBBBBBBBBBBBBCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC", pubKeyToImport, privObj, "SIG_K1_Ka1FvtKxHQzY2yUsM3jDJ3epGzrbXtUwS8kZLNu5iWDjbi7besBdHFu8RoR8b5fcJsrnwqBepeppFHfFoRtN9PLwDkyn8X")


    privKeyToImport = "5HxQKWDznancXZXm7Gr2guadK7BhK9Zs8ejDhfA9oEBM89ZaAru";
    pubKeyToImport = "EOS7dwvuZfiNdTbo3aamP8jgq8RD4kzauNkyiQVjxLtAhDHJm9joQ";
    privObj = importKey(privKeyToImport, pubKeyToImport)
    signAndCheck("6cb75bc5a46a7fdb64b92efefca01ed7b060ab5e0d625226e8efbc0980c3ddc1", pubKeyToImport, privObj, "SIG_K1_K6jyndumSBa6P8tuKSNmsQrpZKTHZwW2FeZzEqs9sAZ23GXivhoZNGTrvvbsTmgsXmEmNeP1wL8vZUZWomb55Uz6MbHyD6")

    </script>
</body>
</html>